<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <title>PEP 304 -- Controlling Generation of Bytecode Files</title>
  <meta name="keywords" content="PEP 304 -- Controlling Generation of Bytecode Files" />
  <meta name="description" content="PEP 304 -- Controlling Generation of Bytecode Files" />
  <link rel="alternate" type="application/rss+xml" title="Community Events"
        href="http://www.python.org/channews.rdf" />
  <link rel="alternate" type="application/rss+xml" title="Python Recipes"
        href="http://aspn.activestate.com/ASPN/Cookbook/Python/index_rss" />
  <link rel="alternate" type="application/rss+xml" title="Usergroup News"
        href="http://python-groups.blogspot.com/feeds/posts/default" />
  <link rel="alternate" type="application/rss+xml" title="Python Screencasts"
        href="http://www.showmedo.com/latestVideoFeed/rss2.0?tag=python" />
  <link rel="alternate" type="application/rss+xml" title="Python Podcasts"
        href="http://www.awaretek.com/python/index.xml" />
  <link rel="alternate" type="application/rss+xml" title="Foundation News"
        href="http://feeds.feedburner.com/PythonSoftwareFoundationNews" />
  <link rel="alternate" type="application/rss+xml" title="Python Enhancement Proposals"
        href="http://www.python.org/dev/peps/peps.rss" />
  <link rel="alternate" type="application/rss+xml" title="Python Job Opportunities"
        href="http://www.python.org/community/jobs/jobs.rss" />
  <link rel="alternate" type="application/rss+xml" title="Reddit Feed of Python What's New Online"
        href="http://www.reddit.com/r/Python/.rss" />
  <link rel="alternate" type="application/rss+xml" title="Python Insider"
        href="http://feeds.feedburner.com/PythonInsider" />

  <link rel="stylesheet" type="text/css" media="screen" id="screen-switcher-stylesheet"
        href="/styles/screen-switcher-default.css" />
  <link rel="stylesheet" type="text/css" media="sc&#82;een"
        href="/styles/netscape4.css" />
  <link rel="stylesheet" type="text/css" media="print"
        href="/styles/print.css" />
  <link rel="alternate stylesheet" type="text/css" media="screen"
        href="/styles/largestyles.css" title="large text" />
  <link rel="alternate stylesheet" type="text/css" media="screen"
        href="/styles/defaultfonts.css" title="default fonts" />

  <link rel="search" type="application/opensearchdescription+xml"
        title="Search under the www.python.org Domain"
        href="/search-pysite.xml"/>

  <link rel="search" type="application/opensearchdescription+xml"
        title="Search within the Python Wiki"
        href="/search-pywiki.xml"/>

  <link rel="search" type="application/opensearchdescription+xml"
        title="Search within Python Books at Google Book Search"
        href="/search-pybooks.xml"/>

  <link rel="search" type="application/opensearchdescription+xml"
        title="Search within the Python Documentation"
        href="/search-pydocs.xml"/>

  <link rel="search" type="application/opensearchdescription+xml"
        title="Search for a Module in the Standard Library"
        href="/search-pymodules.xml"/>

  <link rel="search" type="application/opensearchdescription+xml"
        title="Search for Packages inside the Cheeseshop (PyPI)"
        href="/search-pycheese.xml"/>

  <link rel="search" type="application/opensearchdescription+xml"
        title="Search Archives of the Main Python Mailing List"
        href="/search-pythonlist.xml"/>

  <script type="text/javascript" src="/js/iotbs2-key-directors-load.js"></script>
  <script type="text/javascript" src="/js/iotbs2-directors.js"></script>
  <script type="text/javascript" src="/js/iotbs2-core.js"></script>

</head>


<body>
  <!-- Logo -->
  <h1 id="logoheader">
    <a href="/" id="logolink" accesskey="1"><img id="logo" src="/images/python-logo.gif" alt="homepage" border="0" /></a>
  </h1>
  <!-- Skip to Navigation -->
  <div class="skiptonav"><a href="#left-hand-navigation" accesskey="2"><img src="/images/trans.gif" id="skiptonav" alt="skip to navigation" border="0" /></a></div>
  <div class="skiptonav"><a href="#content-body" accesskey="3"><img src="/images/trans.gif" id="skiptocontent" alt="skip to content" border="0" /></a></div>
  <!-- Utility Menu -->
  <div id="utility-menu">
    <!-- Search Box -->
    <div id="searchbox">
      <form method="get" action="http://google.com/search" id="searchform" name="searchform">
        <div id="search">
          <input type="hidden" id="domains" name="domains" value="www.python.org" />
          <input type="hidden" id="sitesearch" name="sitesearch" value="www.python.org" />
          <input type="hidden" id="sourceid" name="sourceid" value="google-search" />
          <input type="text" class="input-text" name="q" id="q" />
          <input type="submit" value="search" class="input-button" name="submit" id="submit" />
          <a href="/search" class="reference">Advanced Search</a>
        </div>
      </form>
    </div>
    <div id="screen-switcher"></div>
  </div>

  <div id="left-hand-navigation">
    <!-- Main Menu -->
    <div id="menu">
      <ul class="level-one">
            <li>
          <a href="/about/" title="About The Python Language">About</a>
        </li>
            <li>
          <a href="/news/" title="Major Happenings Within the Python Community">News</a>
        </li>
            <li>
          <a href="/doc/" title="Tutorials, Library Reference, C API">Documentation</a>
        </li>
            <li>
          <a href="/download/" title="Start Running Python Under Windows, Mac, Linux and Others">Download</a>
        </li>
            <li>
          <a href="/getit/" title="Alternate Download page for China">ä¸è½½</a>
        </li>
            <li>
          <a href="/community/" title="Mailing Lists, Jobs, Conferences, SIGs, Online Chats">Community</a>
        </li>
            <li>
          <a href="/psf/" title="Python Software Foundation">Foundation</a>
        </li>
            <li>
          <a href="http://docs.python.org/devguide/" title="Development of the Python language and website">Core Development</a>
        </li>
      </ul>
    </div>

    <!-- Quick Links -->
    <h4><a style="margin-top:1.5em" href="http://wiki.python.org/moin/">Python Wiki</a></h4>
    <h4><a style="margin-top:1.5em" href="http://blog.python.org/">Python Insider Blog</a></h4>
    <h4><a style="margin-top:1.5em" href="http://wiki.python.org/moin/Python2orPython3">Python 2 or 3?</a></h4>
    <h4><a style="color:#D58228; margin-top:1.5em" href="/psf/donations/">Help Fund Python</a></h4>
    <div style="align:center; padding-top: 0.5em; padding-left: 1em">
      <a href="/psf/donations/"><img width="116" height="42" src="/images/donate.png" alt="" title="" /></a>
    </div>
    <div style="align:center; padding-top: 0.5em; padding-left: 2.5em">
            <a href="http://wiki.python.org/moin/Languages"><img
	      style="align:center"
              width="94" height="46"
	      src="/images/worldmap.jpg" alt="[Python resources in languages other than English]" /></a>
    </div>
    <div style="align:center; padding-top: 0.0em; padding-left: 0em">
       <h4><a href="http://wiki.python.org/moin/Languages">Non-English Resources</a></h4>
    </div>
    <div class="calendar">
        <iframe src="https://www.google.com/calendar/embed?title=Release%20Schedule&amp;showNav=0&amp;showDate=0&amp;showPrint=0&amp;showTabs=0&amp;showCalendars=0&amp;showTz=0&amp;mode=AGENDA&amp;height=300&amp;wkst=1&amp;bgcolor=%23FFFFFF&amp;src=b6v58qvojllt0i6ql654r1vh00%40group.calendar.google.com&amp;color=%23B1365F&amp;" style=" border-width:0 " width="180" height="300" frameborder="0" scrolling="no">
            <a href="http://www.google.com/calendar/ical/b6v58qvojllt0i6ql654r1vh00%40group.calendar.google.com/public/basic.ics">
                Python Release Schedule iCal Calendar
            </a>
        </iframe>
    </div>
    <div class="calendar">
        <iframe src="https://www.google.com/calendar/embed?title=Events%20Calendar&amp;showNav=0&amp;showDate=0&amp;showPrint=0&amp;showTabs=0&amp;showCalendars=0&amp;showTz=0&amp;mode=AGENDA&amp;height=300&amp;wkst=1&amp;bgcolor=%23FFFFFF&amp;src=j7gov1cmnqr9tvg14k621j7t5c%40group.calendar.google.com&amp;color=%23B1365F&amp;" style=" border-width:0 " width="180" height="300" frameborder="0" scrolling="no">
            <a href="http://www.google.com/calendar/ical/j7gov1cmnqr9tvg14k621j7t5c%40group.calendar.google.com/public/basic.ics">
                Python Events iCal Calendar
            </a>
        </iframe>
        <p class="level-one"><a href="http://pycon.org/#calendar">Add an event</a> to this calendar.</p>
    </div>
    <div class="calendar">
        <iframe src="https://www.google.com/calendar/embed?title=User%20Group%20Calendar&amp;showNav=0&amp;showDate=0&amp;showPrint=0&amp;showTabs=0&amp;showCalendars=0&amp;showTz=0&amp;mode=AGENDA&amp;height=300&amp;wkst=1&amp;bgcolor=%23FFFFFF&amp;src=3haig2m9msslkpf2tn1h56nn9g%40group.calendar.google.com&amp;color=%23125A12&amp;" style=" border-width:0 " width="180" height="300" frameborder="0" scrolling="no">
            <a href="http://www.google.com/calendar/ical/3haig2m9msslkpf2tn1h56nn9g%40group.calendar.google.com/public/basic.ics">
                Python User Group iCal Calendar
            </a>
        </iframe>
        <p class="level-one"><a href="http://pycon.org/#calendar">Add an event</a> to this calendar.</p>
    </div>
  </div>

  <div id="content-body">
    <div id="body-main">
      <div id="content">
        
          <div id="breadcrumb">
               <a href="/dev/peps/">PEP Index</a>
               <span class="breadcrumb-separator">&gt;</span>
            
            PEP 304 -- Controlling Generation of Bytecode Files
          </div>



        <!--
This HTML is auto-generated.  DO NOT EDIT THIS FILE!  If you are writing a new
PEP, see http://www.python.org/dev/peps/pep-0001 for instructions and links
to templates.  DO NOT USE THIS HTML FILE AS YOUR TEMPLATE!
-->
<table class="rfc2822 docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">PEP:</th><td class="field-body">304</td>
</tr>
<tr class="field"><th class="field-name">Title:</th><td class="field-body">Controlling Generation of Bytecode Files</td>
</tr>
<tr class="field"><th class="field-name">Version:</th><td class="field-body">d4aff55ec1b4</td>
</tr>
<tr class="field"><th class="field-name">Last-Modified:</th><td class="field-body"><a class="reference external" href="http://hg.python.org/peps/file/tip/pep-0304.txt">2006-04-27 08:47:55 +0000 (Thu, 27 Apr 2006)</a></td>
</tr>
<tr class="field"><th class="field-name">Author:</th><td class="field-body">Skip Montanaro</td>
</tr>
<tr class="field"><th class="field-name">Status:</th><td class="field-body">Withdrawn</td>
</tr>
<tr class="field"><th class="field-name">Type:</th><td class="field-body">Standards Track</td>
</tr>
<tr class="field"><th class="field-name">Content-Type:</th><td class="field-body"><a class="reference external" href="/dev/peps/pep-0012">text/x-rst</a></td>
</tr>
<tr class="field"><th class="field-name">Created:</th><td class="field-body">22-Jan-2003</td>
</tr>
<tr class="field"><th class="field-name">Post-History:</th><td class="field-body">27-Jan-2003, 31-Jan-2003, 17-Jun-2005</td>
</tr>
</tbody>
</table>
<hr />
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#abstract" id="id14">Abstract</a></li>
<li><a class="reference internal" href="#proposal" id="id15">Proposal</a><ul>
<li><a class="reference internal" href="#glossary" id="id16">Glossary</a></li>
<li><a class="reference internal" href="#locating-bytecode-files" id="id17">Locating bytecode files</a></li>
<li><a class="reference internal" href="#writing-bytecode-files" id="id18">Writing bytecode files</a></li>
<li><a class="reference internal" href="#defining-augmented-directories" id="id19">Defining augmented directories</a></li>
<li><a class="reference internal" href="#fixing-the-location-of-the-bytecode-base" id="id20">Fixing the location of the bytecode base</a></li>
</ul>
</li>
<li><a class="reference internal" href="#rationale" id="id21">Rationale</a></li>
<li><a class="reference internal" href="#alternatives" id="id22">Alternatives</a></li>
<li><a class="reference internal" href="#issues" id="id23">Issues</a></li>
<li><a class="reference internal" href="#examples" id="id24">Examples</a></li>
<li><a class="reference internal" href="#implementation" id="id25">Implementation</a></li>
<li><a class="reference internal" href="#references" id="id26">References</a></li>
<li><a class="reference internal" href="#copyright" id="id27">Copyright</a></li>
</ul>
</div>
<div class="section" id="abstract">
<h1><a class="toc-backref" href="#id14">Abstract</a></h1>
<p>This PEP outlines a mechanism for controlling the generation and
location of compiled Python bytecode files.  This idea originally
arose as a patch request <a class="footnote-reference" href="#id8" id="id1">[1]</a> and evolved into a discussion thread on
the python-dev mailing list <a class="footnote-reference" href="#id9" id="id2">[2]</a>.  The introduction of an environment
variable will allow people installing Python or Python-based
third-party packages to control whether or not bytecode files should
be generated at installation time, and if so, where they should be
written.  It will also allow users to control whether or not bytecode
files should be generated at application run-time, and if so, where
they should be written.</p>
</div>
<div class="section" id="proposal">
<h1><a class="toc-backref" href="#id15">Proposal</a></h1>
<p>Add a new environment variable, PYTHONBYTECODEBASE, to the mix of
environment variables which Python understands.  PYTHONBYTECODEBASE is
interpreted as follows:</p>
<ul>
<li><p class="first">If not defined, Python bytecode is generated in exactly the same way
as is currently done.  sys.bytecodebase is set to the root directory
(either / on Unix and Mac OSX or the root directory of the startup
(installation???) drive -- typically <tt class="docutils literal">C:\</tt> -- on Windows).</p>
</li>
<li><p class="first">If defined and it refers to an existing directory to which the user
has write permission, sys.bytecodebase is set to that directory and
bytecode files are written into a directory structure rooted at that
location.</p>
</li>
<li><p class="first">If defined but empty, sys.bytecodebase is set to None and generation
of bytecode files is suppressed altogether.</p>
</li>
<li><p class="first">If defined and one of the following is true:</p>
<ul class="simple">
<li>it does not refer to a directory,</li>
<li>it refers to a directory, but not one for which the user has write
permission</li>
</ul>
<p>a warning is displayed, sys.bytecodebase is set to None and
generation of bytecode files is suppressed altogether.</p>
</li>
</ul>
<p>After startup initialization, all runtime references are to
sys.bytecodebase, not the PYTHONBYTECODEBASE environment variable.
sys.path is not modified.</p>
<p>From the above, we see sys.bytecodebase can only take on two valid
types of values: None or a string referring to a valid directory on
the system.</p>
<p>During import, this extension works as follows:</p>
<ul class="simple">
<li>The normal search for a module is conducted.  The search order is
roughly: dynamically loaded extension module, Python source file,
Python bytecode file.  The only time this mechanism comes into play
is if a Python source file is found.</li>
<li>Once we've found a source module, an attempt to read a byte-compiled
file in the same directory is made.  (This is the same as before.)</li>
<li>If no byte-compiled file is found, an attempt to read a
byte-compiled file from the augmented directory is made.</li>
<li>If bytecode generation is required, the generated bytecode is wrtten
to the augmented directory if possible.</li>
</ul>
<p>Note that this PEP is explicitly <em>not</em> about providing
module-by-module or directory-by-directory control over the
disposition of bytecode files.</p>
<div class="section" id="glossary">
<h2><a class="toc-backref" href="#id16">Glossary</a></h2>
<ul class="simple">
<li>&quot;bytecode base&quot; refers to the current setting of
sys.bytecodebase.</li>
<li>&quot;augmented directory&quot; refers to the directory formed from the
bytecode base and the directory name of the source file.</li>
<li>PYTHONBYTECODEBASE refers to the environment variable when necessary
to distinguish it from &quot;bytecode base&quot;.</li>
</ul>
</div>
<div class="section" id="locating-bytecode-files">
<h2><a class="toc-backref" href="#id17">Locating bytecode files</a></h2>
<p>When the interpreter is searching for a module, it will use sys.path
as usual.  However, when a possible bytecode file is considered, an
extra probe for a bytecode file may be made.  First, a check is made
for the bytecode file using the directory in sys.path which holds the
source file (the current behavior).  If a valid bytecode file is not
found there (either one does not exist or exists but is out-of-date)
and the bytecode base is not None, a second probe is made using the
directory in sys.path prefixed appropriately by the bytecode base.</p>
</div>
<div class="section" id="writing-bytecode-files">
<h2><a class="toc-backref" href="#id18">Writing bytecode files</a></h2>
<p>When the bytecode base is not None, a new bytecode file is written to
the appropriate augmented directory, never directly to a directory in
sys.path.</p>
</div>
<div class="section" id="defining-augmented-directories">
<h2><a class="toc-backref" href="#id19">Defining augmented directories</a></h2>
<p>Conceptually, the augmented directory for a bytecode file is the
directory in which the source file exists prefixed by the bytecode
base.  In a Unix environment this would be:</p>
<pre class="literal-block">
pcb = os.path.abspath(sys.bytecodebase)
if sourcefile[0] == os.sep: sourcefile = sourcefile[1:]
augdir = os.path.join(pcb, os.path.dirname(sourcefile))
</pre>
<p>On Windows, which does not have a single-rooted directory tree, the
drive letter of the directory containing the source file is treated as
a directory component after removing the trailing colon.  The
augmented directory is thus derived as</p>
<pre class="literal-block">
pcb = os.path.abspath(sys.bytecodebase)
drive, base = os.path.splitdrive(os.path.dirname(sourcefile))
drive = drive[:-1]
if base[0] == &quot;\\&quot;: base = base[1:]
augdir = os.path.join(pcb, drive, base)
</pre>
</div>
<div class="section" id="fixing-the-location-of-the-bytecode-base">
<h2><a class="toc-backref" href="#id20">Fixing the location of the bytecode base</a></h2>
<p>During program startup, the value of the PYTHONBYTECODEBASE
environment variable is made absolute, checked for validity and added
to the sys module, effectively:</p>
<pre class="literal-block">
pcb = os.path.abspath(os.environ[&quot;PYTHONBYTECODEBASE&quot;])
probe = os.path.join(pcb, &quot;foo&quot;)
try:
    open(probe, &quot;w&quot;)
except IOError:
    sys.bytecodebase = None
else:
    os.unlink(probe)
    sys.bytecodebase = pcb
</pre>
<p>This allows the user to specify the bytecode base as a relative path,
but not have it subject to changes to the current working directory
during program execution.  (I can't imagine you'd want it to move
around during program execution.)</p>
<p>There is nothing special about sys.bytecodebase.  The user may change
it at runtime if desired, but normally it will not be modified.</p>
</div>
</div>
<div class="section" id="rationale">
<h1><a class="toc-backref" href="#id21">Rationale</a></h1>
<p>In many environments it is not possible for non-root users to write
into directories containing Python source files.  Most of the time,
this is not a problem as Python source is generally byte compiled
during installation.  However, there are situations where bytecode
files are either missing or need to be updated.  If the directory
containing the source file is not writable by the current user a
performance penalty is incurred each time a program importing the
module is run. <a class="footnote-reference" href="#id10" id="id3">[3]</a> Warning messages may also be generated in certain
circumstances.  If the directory is writable, nearly simultaneous
attempts attempts to write the bytecode file by two separate processes
may occur, resulting in file corruption. <a class="footnote-reference" href="#id11" id="id4">[4]</a></p>
<p>In environments with RAM disks available, it may be desirable for
performance reasons to write bytecode files to a directory on such a
disk.  Similarly, in environments where Python source code resides on
network file systems, it may be desirable to cache bytecode files on
local disks.</p>
</div>
<div class="section" id="alternatives">
<h1><a class="toc-backref" href="#id22">Alternatives</a></h1>
<p>The only other alternative proposed so far <a class="footnote-reference" href="#id8" id="id5">[1]</a> seems to be to add a
-R flag to the interpreter to disable writing bytecode files
altogether.  This proposal subsumes that.  Adding a command-line
option is certainly possible, but is probably not sufficient, as the
interpreter's command line is not readily available during
installation (early during program startup???).</p>
</div>
<div class="section" id="issues">
<h1><a class="toc-backref" href="#id23">Issues</a></h1>
<ul class="simple">
<li>Interpretation of a module's __file__ attribute.  I believe the
__file__ attribute of a module should reflect the true location of
the bytecode file.  If people want to locate a module's source code,
they should use imp.find_module(module).</li>
<li>Security - What if root has PYTHONBYTECODEBASE set?  Yes, this can
present a security risk, but so can many other things the root user
does.  The root user should probably not set PYTHONBYTECODEBASE
except possibly during installation.  Still, perhaps this problem
can be minimized.  When running as root the interpreter should check
to see if PYTHONBYTECODEBASE refers to a directory which is writable
by anyone other than root.  If so, it could raise an exception or
warning and set sys.bytecodebase to None.  Or, see the next item.</li>
<li>More security - What if PYTHONBYTECODEBASE refers to a general
directory (say, /tmp)?  In this case, perhaps loading of a
preexisting bytecode file should occur only if the file is owned by
the current user or root.  (Does this matter on Windows?)</li>
<li>The interaction of this PEP with import hooks has not been
considered yet.  In fact, the best way to implement this idea might
be as an import hook.  See <a class="reference external" href="/dev/peps/pep-0302">PEP 302</a>. <a class="footnote-reference" href="#id12" id="id6">[5]</a></li>
<li>In the current (pre-<a class="reference external" href="/dev/peps/pep-0304">PEP 304</a>) environment, it is safe to delete a
source file after the corresponding bytecode file has been created,
since they reside in the same directory.  With <a class="reference external" href="/dev/peps/pep-0304">PEP 304</a> as currently
defined, this is not the case.  A bytecode file in the augmented
directory is only considered when the source file is present and it
thus never considered when looking for module files ending in
&quot;.pyc&quot;.  I think this behavior may have to change.</li>
</ul>
</div>
<div class="section" id="examples">
<h1><a class="toc-backref" href="#id24">Examples</a></h1>
<p>In the examples which follow, the urllib source code resides in
/usr/lib/python2.3/urllib.py and /usr/lib/python2.3 is in sys.path but
is not writable by the current user.</p>
<ul class="simple">
<li>The bytecode base is /tmp.  /usr/lib/python2.3/urllib.pyc exists and
is valid.  When urllib is imported, the contents of
/usr/lib/python2.3/urllib.pyc are used.  The augmented directory is
not consulted.  No other bytecode file is generated.</li>
<li>The bytecode base is /tmp.  /usr/lib/python2.3/urllib.pyc exists,
but is out-of-date.  When urllib is imported, the generated bytecode
file is written to urllib.pyc in the augmented directory which has
the value /tmp/usr/lib/python2.3.  Intermediate directories will be
created as needed.</li>
<li>The bytecode base is None.  No urllib.pyc file is found.  When
urllib is imported, no bytecode file is written.</li>
<li>The bytecode base is /tmp.  No urllib.pyc file is found.  When
urllib is imported, the generated bytecode file is written to the
augmented directory which has the value /tmp/usr/lib/python2.3.
Intermediate directories will be created as needed.</li>
<li>At startup, PYTHONBYTECODEBASE is /tmp/foobar, which does not exist.
A warning is emitted, sys.bytecodebase is set to None and no
bytecode files are written during program execution unless
sys.bytecodebase is later changed to refer to a valid,
writable directory.</li>
<li>At startup, PYTHONBYTECODEBASE is set to /, which exists, but is not
writable by the current user.  A warning is emitted,
sys.bytecodebase is set to None and no bytecode files are
written during program execution unless sys.bytecodebase is
later changed to refer to a valid, writable directory.  Note that
even though the augmented directory constructed for a particular
bytecode file may be writable by the current user, what counts is
that the bytecode base directory itself is writable.</li>
<li>At startup PYTHONBYTECODEBASE is set to the empty string.
sys.bytecodebase is set to None.  No warning is generated, however.
If no urllib.pyc file is found when urllib is imported, no bytecode
file is written.</li>
</ul>
<p>In the Windows examples which follow, the urllib source code resides
in <tt class="docutils literal"><span class="pre">C:\PYTHON22\urllib.py</span></tt>.  <tt class="docutils literal"><span class="pre">C:\PYTHON22</span></tt> is in sys.path but is
not writable by the current user.</p>
<ul class="simple">
<li>The bytecode base is set to <tt class="docutils literal"><span class="pre">C:\TEMP</span></tt>.  <tt class="docutils literal"><span class="pre">C:\PYTHON22\urllib.pyc</span></tt>
exists and is valid.  When urllib is imported, the contents of
<tt class="docutils literal"><span class="pre">C:\PYTHON22\urllib.pyc</span></tt> are used.  The augmented directory is not
consulted.</li>
<li>The bytecode base is set to <tt class="docutils literal"><span class="pre">C:\TEMP</span></tt>.  <tt class="docutils literal"><span class="pre">C:\PYTHON22\urllib.pyc</span></tt>
exists, but is out-of-date.  When urllib is imported, a new bytecode
file is written to the augmented directory which has the value
<tt class="docutils literal"><span class="pre">C:\TEMP\C\PYTHON22</span></tt>.  Intermediate directories will be created as
needed.</li>
<li>At startup PYTHONBYTECODEBASE is set to <tt class="docutils literal">TEMP</tt> and the current
working directory at application startup is <tt class="docutils literal"><span class="pre">H:\NET</span></tt>.  The
potential bytecode base is thus <tt class="docutils literal"><span class="pre">H:\NET\TEMP</span></tt>.  If this directory
exists and is writable by the current user, sys.bytecodebase will be
set to that value.  If not, a warning will be emitted and
sys.bytecodebase will be set to None.</li>
<li>The bytecode base is <tt class="docutils literal"><span class="pre">C:\TEMP</span></tt>.  No urllib.pyc file is found.
When urllib is imported, the generated bytecode file is written to
the augmented directory which has the value <tt class="docutils literal"><span class="pre">C:\TEMP\C\PYTHON22</span></tt>.
Intermediate directories will be created as needed.</li>
</ul>
</div>
<div class="section" id="implementation">
<h1><a class="toc-backref" href="#id25">Implementation</a></h1>
<p>See the patch on Sourceforge. <a class="footnote-reference" href="#id13" id="id7">[6]</a></p>
</div>
<div class="section" id="references">
<h1><a class="toc-backref" href="#id26">References</a></h1>
<table class="docutils footnote" frame="void" id="id8" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id5">2</a>)</em> patch 602345, Option for not writing py.[co] files, Klose
(<a class="reference external" href="http://www.python.org/sf/602345">http://www.python.org/sf/602345</a>)</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id9" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[2]</a></td><td>python-dev thread, Disable writing .py[co], Norwitz
(<a class="reference external" href="http://mail.python.org/pipermail/python-dev/2003-January/032270.html">http://mail.python.org/pipermail/python-dev/2003-January/032270.html</a>)</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id10" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[3]</a></td><td>Debian bug report, Mailman is writing to /usr in cron, Wegner
(<a class="reference external" href="http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=96111">http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=96111</a>)</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id11" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[4]</a></td><td>python-dev thread, Parallel pyc construction, Dubois
(<a class="reference external" href="http://mail.python.org/pipermail/python-dev/2003-January/032060.html">http://mail.python.org/pipermail/python-dev/2003-January/032060.html</a>)</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id12" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id6">[5]</a></td><td><a class="reference external" href="/dev/peps/pep-0302">PEP 302</a>, New Import Hooks, van Rossum and Moore
(<a class="reference external" href="http://www.python.org/dev/peps/pep-0302">http://www.python.org/dev/peps/pep-0302</a>)</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id13" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id7">[6]</a></td><td>patch 677103, PYTHONBYTECODEBASE patch (<a class="reference external" href="/dev/peps/pep-0304">PEP 304</a>), Montanaro
(<a class="reference external" href="http://www.python.org/sf/677103">http://www.python.org/sf/677103</a>)</td></tr>
</tbody>
</table>
</div>
<div class="section" id="copyright">
<h1><a class="toc-backref" href="#id27">Copyright</a></h1>
<p>This document has been placed in the public domain.</p>
<!-- Local Variables:
mode: indented-text
indent-tabs-mode: nil
sentence-end-double-space: t
fill-column: 70
End: -->
</div>



      </div>

      
      <div id="footer">
	<div id="credits">
 	  <a href="/about/website">Website maintained by the Python community</a><br/>
	  <a href="http://www.xs4all.com/" title="Web and email hosting provided by xs4all, Netherlands">hosting by xs4all</a> /
	  <a href="http://www.timparkin.co.uk/" title="Design by Tim Parkin, Yorkshire man, photographer and developer">design by Tim Parkin</a>
	</div>
	Copyright &copy; 1990-2013, <a href='/psf/'>Python Software Foundation</a><br/>
	<a href="/about/legal">Legal Statements</a>
      </div>


    </div>
  </div>
</body>
</html>






